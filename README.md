# SwitchProxy - macOS 代理快速切换应用

一个基于 Electron 的 macOS 应用，用于快速切换系统代理设置。

## 功能特性

- ✅ 支持 HTTP/HTTPS 和 SOCKS5 代理
- ✅ 快速切换多个代理配置
- ✅ 一键开启/关闭代理
- ✅ 代理配置管理（添加、编辑、删除）
- ✅ 配置持久化存储
- ✅ 现代化的用户界面

## 项目结构

```
switchProxy/
├── src/
│   ├── main/              # Electron 主进程
│   │   ├── main.js        # 主进程入口
│   │   ├── proxy-manager.js    # 代理管理核心逻辑
│   │   ├── proxy-storage.js    # 配置存储模块
│   │   └── system-proxy.js     # 系统代理设置接口
│   ├── renderer/          # 渲染进程（UI）
│   │   ├── index.html     # HTML 入口
│   │   ├── app.js         # 前端逻辑
│   │   └── styles/
│   │       └── main.css   # 样式文件
│   └── preload.js         # 预加载脚本
├── assets/                # 资源文件
├── build/                 # 构建配置
├── package.json
├── electron-builder.yml
└── README.md
```

## 开发

### 安装依赖

```bash
npm install
```

### 启动开发模式

```bash
npm run dev
```

开发模式会自动打开开发者工具，方便调试。

### 构建应用

#### 本地构建

```bash
# 构建 macOS 应用
npm run build:mac
```

构建完成后，应用将打包为 `.dmg` 文件，位于 `dist` 目录。

#### 使用 GitHub Actions 自动构建

项目已配置 GitHub Actions 自动构建：

- **自动构建**: 推送到 `main`/`master` 分支或创建 Pull Request 时自动构建
- **手动触发**: 在 GitHub Actions 页面可以手动触发构建
- **自动发布**: 创建以 `v` 开头的 tag（如 `v1.0.0`）时，会自动创建 Release 并上传构建产物

构建产物会作为 Artifacts 上传，可以在 Actions 页面下载。

## 使用说明

### 添加代理配置

1. 点击"添加代理"按钮
2. 填写代理信息：
   - **代理名称**: 便于识别的名称（如：公司代理、VPN 代理）
   - **代理类型**: 选择 HTTP/HTTPS 或 SOCKS5
   - **主机地址**: 代理服务器地址（如：127.0.0.1）
   - **端口**: 代理服务器端口（如：8080）
3. 点击"保存"

### 切换代理

1. 在代理列表中，点击要使用的代理的"切换"按钮
2. 选中的代理会高亮显示

### 开启/关闭代理

1. 确保已选择一个代理
2. 点击"开启代理"或"关闭代理"按钮
3. 首次操作时，系统会提示输入管理员密码

### 编辑代理

1. 在代理列表中，点击要编辑的代理的"编辑"按钮
2. 修改代理信息
3. 点击"保存"

### 删除代理

1. 在代理列表中，点击要删除的代理的"删除"按钮
2. 确认删除操作

## 技术实现

### 系统代理设置

应用通过 macOS 的 `networksetup` 命令来修改系统代理设置。该操作需要管理员权限，因此会使用 `sudo-prompt` 来获取权限。

### 配置存储

使用 `electron-store` 来持久化存储代理配置，配置保存在用户目录下。

### 进程间通信

使用 Electron 的 IPC（Inter-Process Communication）机制在主进程和渲染进程之间通信，通过 `preload.js` 暴露安全的 API。

## 注意事项

1. **权限要求**: 修改系统代理设置需要管理员权限，首次操作时会提示输入密码
2. **网络接口**: 应用会自动检测当前活跃的网络接口（通常是 Wi-Fi），如果检测失败会默认使用 "Wi-Fi"
3. **代理类型**: 
   - HTTP/HTTPS 代理会同时设置 Web 代理和安全 Web 代理
   - SOCKS5 代理会设置防火墙代理
4. **配置持久化**: 代理配置会自动保存，下次启动应用时会自动加载

## 故障排除

### 代理无法开启

- 检查是否已选择代理配置
- 确认输入的管理员密码正确
- 检查代理服务器地址和端口是否正确

### 权限错误

- 确保应用有权限修改系统设置
- 尝试重新输入管理员密码

### 代理不生效

- 检查代理服务器是否正常运行
- 确认代理类型与服务器类型匹配
- 检查网络连接是否正常

## 开发计划

- [ ] 支持代理测试功能
- [ ] 支持代理自动切换规则
- [ ] 支持导入/导出配置
- [ ] 添加代理使用统计

## 许可证

MIT


